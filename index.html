<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>reveal.js</title>

    <link rel="stylesheet" href="dist/reset.css" />
    <link rel="stylesheet" href="dist/reveal.css" />
    <link rel="stylesheet" href="dist/theme/black.css" />

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/monokai.css" />
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section>
          <h2>DB 적재 프로세스관련 기술공유</h2>
          <p>
            <small
              >Created by 동훈@<a href="http://all4land.com/" target="_blank">올포랜드</a>
            </small>
          </p>
        </section>

        <section>
          <h2>목차</h2>
          <ol>
            <li>개요</li>
            <li>SCP로 서버간 파일이동</li>
            <li>DB 적재</li>
            <li>SQL 쿼리 테스트</li>
          </ol>
        </section>

        <section data-transition="slide" data-background="#0064a5">
          <h2>SQL 쿼리 테스트</h2>
        </section>

        <section data-transition="slide" data-background="#0064a5">
          <h4>원격 서버 데이터베이스 접근</h4>
          <pre><code class="hljs sh" data-trim data-line-numbers="1-2|4-5">
            # ssh [user@]hostname [command]
            ssh ppark@211.178.39.246 -p 12522

            # psql -h {호스트명} -p {포트번호} -U {사용자명} -d {데이터베이스명}
            psql -h localhost -p 5432 -U postgres -d hils
          </code></pre>
          <ul>
            <li style="font-size: 20px">
              보안상 원격 서버의 데이터베이스에 바로 접근하지 않고, 우선 ssh로 원격 서버에 접근한
              다음에 데이터베이스에 접근하는 것이 국룰이다.
            </li>
            <li style="font-size: 20px">
              ssh는 일반적으로 원격 시스템에 로그인하고 명령을 실행하는 데 사용된다. 터널링 및 포트
              포워딩에도 사용된다.
            </li>
            <li style="font-size: 20px">
              psql은 PostgreSQL 대화형 터미널 프로그램으로 대화형으로 SQL 명령을 편집/실행 할 수
              있다.
            </li>
          </ul>
        </section>

        <section data-transition="slide" data-background="#0064a5">
          <h4>유용한 psql 커맨드</h4>
          <pre><code class="hljs SQL" data-trim data-line-numbers="1-2|4-5|7-8|10-11|13-14|16-17">
            -- 모든 데이터베이스 목록보기 
            \l

            -- 모든 스키마 목록보기
            \dn

            -- 모든 테이블 목록보기
            \dt

            -- 특정 스키마 내의 모든 테이블 목록보기
            \dt {schema_name}.*

            -- psql 스크린 클리어하기
            \! clear

            -- psql 커맨드라인 세션 종료하기
            \q
          </code></pre>
        </section>

        <section data-transition="slide" data-background="#0064a5">
          <h4>모든 카테고리 조회</h4>
          <pre><code class="hljs SQL" data-trim>
            SELECT * FROM cases_hindcasts.categories;
          </code></pre>
        </section>

        <section data-transition="slide" data-background="#0064a5">
          <h4>모든 카테고리 조회</h4>
          <img data-src="dist/images/sql/sql_query_1.jpg" />
        </section>

        <section data-transition="slide" data-background="#0064a5">
          <h4>데이터셋별 모든 변수 조회</h4>
          <pre><code class="hljs SQL" data-trim>
            -- 데이터셋 식별자가 1에 해당하는 모든 변수 조회
            SELECT
                variables.var_id,
                variables.var_name,
                variables.var_long_name,
                variables.var_standard_name,
                variables.var_units,
                variables.dataset_id
            FROM cases_hindcasts.variables
            INNER JOIN cases_hindcasts.datasets ON
                datasets.dataset_id = variables.dataset_id
            WHERE 
                datasets.dataset_id = 1;
          </code></pre>
        </section>

        <section data-transition="slide" data-background="#0064a5">
          <h4>데이터셋별 모든 변수 조회</h4>
          <img data-src="dist/images/sql/sql_query_2.jpg" />
        </section>

        <section data-transition="slide" data-background="#0064a5">
          <h4>카테고리별 모든 데이터셋 조회</h4>
          <pre><code class="hljs SQL" data-trim>
            -- 태풍 카테고리에 해당하는 모든 데이터셋 조회
            SELECT
                datasets.dataset_id,
                datasets.dataset_name,
                datasets.category_id,
                datasets.time_start,
                datasets.time_end
            FROM cases_hindcasts.datasets
            INNER JOIN cases_hindcasts.categories
                ON categories.category_id = datasets.category_id
            WHERE
                category_name=COALESCE(NULL, 'typhoon');
          </code></pre>
        </section>

        <section data-transition="slide" data-background="#0064a5">
          <h4>카테고리별 모든 데이터셋 조회</h4>
          <img data-src="dist/images/sql/sql_query_3.jpg" />
        </section>

        <section data-transition="slide" data-background="#0064a5">
          <h4>연도별 모든 데이터셋 조회</h4>
          <pre><code class="hljs SQL" data-trim>
            -- 2021년에 해당하는 모든 데이터셋 조회
            SELECT
                dataset_id,
                dataset_name,
                datasets.time_start,
                datasets.time_end
            FROM cases_hindcasts.datasets
            WHERE 
                EXTRACT(year FROM time_start) = 2012 OR 
                EXTRACT(year FROM time_end) = 2012;
          </code></pre>
        </section>

        <section data-transition="slide" data-background="#0064a5">
          <h4>연도별 모든 데이터셋 조회</h4>
          <img data-src="dist/images/sql/sql_query_4.jpg" />
        </section>
      </div>
    </div>

    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
        hash: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes],
      });
    </script>
  </body>
</html>
